mode: real
# Live trading config for Swapper real orders
# IMPORTANT: Use tiny amounts only; this file sets dry_run=false.
# Test default exchange (if needed when mode=test):
test_exchange: binance

# Runtime
timeout_ms: 20000
order_type: limit
time_in_force: GTC   # Rest last hop until protective price is reached
max_slippage_bps: 25
min_notional: 1

# Live mode
# Set to false to actually place orders
# WARNING: This will execute real orders using your API keys
# Ensure API keys are configured and permissions are correct (spot trading only)
dry_run: false

# Fast execution flags
# Small wait between hops to allow wallet balances to settle on the exchange
settle_sleep_ms: 100  # ms; faster chain with limits
confirm_fill: false   # avoid extra fetch_order (faster; set true for fee/filled precision)

# Per-exchange minimum test amount (in quote currency, typically USDT)
# Used only when mode=test and no explicit --amount is provided.
# If an exchange is not listed, a default of 1.0 will be used.
test_min_amounts:
  binance: 10.0
  okx: 1.0
  bitget: 1.0
  mexc: 1.0

# Manual blacklist for radar / path building (live).
# OKX returned sCode 51155 (compliance restriction) on USDC/USDT cycle leg; exclude until resolved.
blacklist_pairs:
  okx:
    - USDC/USDT  # sCode 51155 compliance restriction

# Round-trip mirror settings so last hop buys back same tokens at equal or better terms
roundtrip_mirror_last_leg: true
roundtrip_mirror_price_offset_bps: 5    # require ~0.05% improvement over entry (tune 5-10 bps)
roundtrip_mirror_amount_tolerance_bps: 5

# Mirror re-emit settings (optional)
# After TTL seconds, if order is still open and mid moved favorably versus entry,
# cancel & replace at min(entry*(1-off), mid*(1-safety)) for buys; symmetric for sells.
# Set mirror_reemit_ttl_sec=0 to disable.
mirror_reemit_ttl_sec: 90      # seconds between checks (faster refresh to track mid)
mirror_reemit_safety_bps: 5    # 0.05% below mid for buys (above for sells)
mirror_reemit_max: 2           # up to 2 re-emits per last-hop

# Time-based relaxation to avoid being stuck if price runs away from entry
# After mirror_relax_after_sec, allow crossing entry by relax_bps_per_ttl each TTL cycle,
# capped by mirror_relax_max_bps. Set zeros to disable.
mirror_relax_after_sec: 120
mirror_relax_bps_per_ttl: 1
mirror_relax_max_bps: 8

# Forced close: after timeout seconds, optionally close remaining with market
# roundtrip_allow_max_loss_bps caps allowed loss vs entry at close time; set 0 to disable guard.
# Set mirror_close_timeout_sec=0 to disable forced close entirely.
mirror_close_timeout_sec: 900
roundtrip_allow_max_loss_bps: 3

# Sizing: auto cap for first hop with per-exchange/symbol overrides
# mode: auto|manual (manual uses plan.amount as-is; auto ignores plan.amount when 0)
sizing:
  mode: auto
  # USD sizing knobs (simple, low-risk):
  alpha_tob: 15        # base USD per trade; if dv factor used, alpha is baseline USD
  beta_dv_pct: 0.10    # modest volume factor: +$10 per 10% DV estimate
  min_usd: 10          # raise to surpass Binance mins and reduce dust
  max_usd: 25          # clamp upper bound
  ladder_levels: 1     # not used yet (future laddered mirrors)
  ladder_step_bps: 0.0 # spacing between ladder levels
  overrides:
    binance:
      ZEC/USDT:
        min_usd: 12
        max_usd: 25
